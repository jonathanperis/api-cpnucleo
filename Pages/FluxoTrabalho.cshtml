@page
@model FluxoTrabalhoModel
@{
    ViewData["Title"] = "Fluxo de Trabalho";
}

@section Styles {
    <!-- Toastr script -->
    <link href="~/css/plugins/toastr/toastr.min.css" rel="stylesheet">
    <style>
        .image-align {
            background-repeat: no-repeat !important;
            background-position: bottom right !important;
        }
    </style>
}

<div class="row">
    @if (Model.Lista != null)
    {
        @Html.AntiForgeryToken()

        foreach (var workflow in Model.Lista)
        {
            <div class="col-lg-@ViewData["col-lg-*"]">
                <div class="ibox">
                    <div class="ibox-content">
                        <h3>@workflow.Nome <span id="workflow-animate-@workflow.IdWorkflow" class="animated"><span id="workflow-badge-@workflow.IdWorkflow" class="badge">@workflow.ListaTarefas.Count()</span></span></h3>
                        <p class="small"><i class="fa fa-hand-o-up"></i> Arraste a tarefa entre as listas</p>
                        <ul class="sortable-list connectList agile-list ui-sortable" id="workflow-id-@workflow.IdWorkflow">
                            @foreach (var tarefa in workflow.ListaTarefas)
                            {
                                if (DateTime.Now.Date >= tarefa.DataInicio && DateTime.Now.Date <= tarefa.DataTermino)
                                {
                                    if (tarefa.IdTipoTarefa == 1)
                                    {
                                        <li class="success-element image-align" id="@tarefa.IdTarefa" data-idworkflow="@workflow.IdWorkflow" style="background-image:url(../gif/gif-projeto.gif);">
                                            @tarefa.Nome
                                            <div class="agile-detail">
                                                <i class="fa fa-clock-o"></i> @tarefa.DataTermino.Value.ToString("dd/MM/yyyy")
                                                <div class="m-xxs m-l-none"><i class="fa fa-user"></i> #@tarefa.IdTarefa criada por @tarefa.Recurso.Nome</div>
                                                <i class="fa fa-plus-square-o"></i> <font color="1c84c6"> @tarefa.QtdHoras horas planejadas</font>
                                                @if (@tarefa.HorasConsumidas != 0)
                                                {
                                                    <br>
                                                    <i class="fa fa-minus-square-o"></i> <font color="f8ac59">  @tarefa.HorasConsumidas horas consumidas</font>
                                                    if (@tarefa.HorasRestantes >= 0)
                                                    {
                                                        <text>
                                                            <br>
                                                            <i class="fa fa-smile-o"></i> <font color="1ab394"> @tarefa.HorasRestantes horas restantes</font>
                                                        </text>
                                                    }
                                                    else
                                                    {
                                                        <text>
                                                            <br>
                                                            <i class="fa fa-frown-o"></i><font color="ed5565"> @tarefa.HorasRestantes.ToString().Replace("-", "") horas excedidas</font>
                                                        </text>
                                                    }
                                                }
                                            </div>
                                        </li>
                                    }
                                    else if (tarefa.IdTipoTarefa == 2)
                                    {
                                        <li class="success-element image-align" id="@tarefa.IdTarefa" data-idworkflow="@workflow.IdWorkflow" style="background-image:url(../gif/gif-problema.gif);">
                                            @tarefa.Nome
                                            <div class="agile-detail">
                                                <i class="fa fa-clock-o"></i> @tarefa.DataTermino.Value.ToString("dd/MM/yyyy")
                                                <div class="m-xxs m-l-none"><i class="fa fa-user"></i> #@tarefa.IdTarefa criada por @tarefa.Recurso.Nome</div>
                                                <i class="fa fa-plus-square-o"></i> <font color="1c84c6"> @tarefa.QtdHoras horas planejadas</font>
                                                @if (@tarefa.HorasConsumidas != 0)
                                                {
                                                    <br>
                                                    <i class="fa fa-minus-square-o"></i> <font color="f8ac59">  @tarefa.HorasConsumidas horas consumidas</font>
                                                    if (@tarefa.HorasRestantes >= 0)
                                                    {
                                                        <text>
                                                            <br>
                                                            <i class="fa fa-smile-o"></i> <font color="1ab394"> @tarefa.HorasRestantes horas restantes</font>
                                                        </text>
                                                    }
                                                    else
                                                    {
                                                        <text>
                                                            <br>
                                                            <i class="fa fa-frown-o"></i><font color="ed5565"> @tarefa.HorasRestantes.ToString().Replace("-", "") horas excedidas</font>
                                                        </text>
                                                    }
                                                }
                                            </div>
                                        </li>
                                    }
                                    else if (tarefa.IdTipoTarefa == 3)
                                    {
                                        <li class="success-element image-align" id="@tarefa.IdTarefa" data-idworkflow="@workflow.IdWorkflow" style="background-image:url(../gif/gif-melhoria.gif);">
                                            @tarefa.Nome
                                            <div class="agile-detail">
                                                <i class="fa fa-clock-o"></i> @tarefa.DataTermino.Value.ToString("dd/MM/yyyy")
                                                <div class="m-xxs m-l-none"><i class="fa fa-user"></i> #@tarefa.IdTarefa criada por @tarefa.Recurso.Nome</div>
                                                <i class="fa fa-plus-square-o"></i> <font color="1c84c6"> @tarefa.QtdHoras horas planejadas</font>
                                                @if (@tarefa.HorasConsumidas != 0)
                                                {
                                                    <br>
                                                    <i class="fa fa-minus-square-o"></i> <font color="f8ac59">  @tarefa.HorasConsumidas horas consumidas</font>
                                                    if (@tarefa.HorasRestantes >= 0)
                                                    {
                                                        <text>
                                                            <br>
                                                            <i class="fa fa-smile-o"></i> <font color="1ab394"> @tarefa.HorasRestantes horas restantes</font>
                                                        </text>
                                                    }
                                                    else
                                                    {
                                                        <text>
                                                            <br>
                                                            <i class="fa fa-frown-o"></i><font color="ed5565"> @tarefa.HorasRestantes.ToString().Replace("-", "") horas excedidas</font>
                                                        </text>
                                                    }
                                                }
                                            </div>
                                        </li>
                                    }
                                    else if (tarefa.IdTipoTarefa == 4)
                                    {
                                        <li class="success-element image-align" id="@tarefa.IdTarefa" data-idworkflow="@workflow.IdWorkflow" style="background-image:url(../gif/gif-requisicao.gif);">
                                            @tarefa.Nome
                                            <div class="agile-detail">
                                                <i class="fa fa-clock-o"></i> @tarefa.DataTermino.Value.ToString("dd/MM/yyyy")
                                                <div class="m-xxs m-l-none"><i class="fa fa-user"></i> #@tarefa.IdTarefa criada por @tarefa.Recurso.Nome</div>
                                                <i class="fa fa-plus-square-o"></i> <font color="1c84c6"> @tarefa.QtdHoras horas planejadas</font>
                                                @if (@tarefa.HorasConsumidas != 0)
                                                {
                                                    <br>
                                                    <i class="fa fa-minus-square-o"></i> <font color="f8ac59">  @tarefa.HorasConsumidas horas consumidas</font>
                                                    if (@tarefa.HorasRestantes >= 0)
                                                    {
                                                        <text>
                                                            <br>
                                                            <i class="fa fa-smile-o"></i> <font color="1ab394"> @tarefa.HorasRestantes horas restantes</font>
                                                        </text>
                                                    }
                                                    else
                                                    {
                                                        <text>
                                                            <br>
                                                            <i class="fa fa-frown-o"></i><font color="ed5565"> @tarefa.HorasRestantes.ToString().Replace("-", "") horas excedidas</font>
                                                        </text>
                                                    }
                                                }
                                            </div>
                                        </li>
                                    }
                                    <!--<li class="success-element" id="@tarefa.IdTarefa" data-idworkflow="@workflow.IdWorkflow">
                                        @tarefa.Nome
                                        <div class="agile-detail">
                                            <i class="fa fa-clock-o"></i> @tarefa.DataTermino.Value.ToString("dd/MM/yyyy")
                                            <div class="m-xxs m-l-none"><i class="fa fa-user"></i> #@tarefa.IdTarefa criada por @tarefa.Recurso.Nome</div>
                                            <i class="fa fa-plus-square-o"></i> <font color="1c84c6"> @tarefa.QtdHoras horas planejadas</font>
                                            @if (@tarefa.HorasConsumidas != 0)
                                            {
                                                <br>
                                                <i class="fa fa-minus-square-o"></i> <font color="f8ac59">  @tarefa.HorasConsumidas horas consumidas</font>
                                                if (@tarefa.HorasRestantes >= 0)
                                                {
                                                    <text>
                                                    <br>
                                                    <i class="fa fa-smile-o"></i> <font color="1ab394"> @tarefa.HorasRestantes horas restantes</font>
                                                    </text>
                                                }
                                                else
                                                {
                                                    <text>
                                                    <br>
                                                    <i class="fa fa-frown-o"></i><font color="ed5565"> @tarefa.HorasRestantes.ToString().Replace("-", "") horas excedidas</font>
                                                    </text>
                                                }
                                            }
                                        </div>
                                    </li>-->
                                }
                                else if (tarefa.ListaImpedimentos.Count(x => x.Ativo) > 0)
                                {
                                    if (tarefa.IdTipoTarefa == 1)
                                    {
                                        <li class="warning-element image-align" id="@tarefa.IdTarefa" data-idworkflow="@workflow.IdWorkflow" style="background-image:url(../gif/gif-projeto.gif);">
                                            @tarefa.Nome
                                            <div class="agile-detail">
                                                <i class="fa fa-clock-o"></i> @tarefa.DataTermino.Value.ToString("dd/MM/yyyy")
                                                <div class="m-xxs m-l-none"><i class="fa fa-user"></i> #@tarefa.IdTarefa criada por @tarefa.Recurso.Nome</div>
                                                <i class="fa fa-plus-square-o"></i> <font color="1c84c6"> @tarefa.QtdHoras horas planejadas</font>
                                                @if (@tarefa.HorasConsumidas != 0)
                                                {
                                                    <br>
                                                    <i class="fa fa-minus-square-o"></i> <font color="f8ac59">  @tarefa.HorasConsumidas horas consumidas</font>
                                                    if (@tarefa.HorasRestantes >= 0)
                                                    {
                                                        <text>
                                                            <br>
                                                            <i class="fa fa-smile-o"></i> <font color="1ab394"> @tarefa.HorasRestantes horas restantes</font>
                                                        </text>
                                                    }
                                                    else
                                                    {
                                                        <text>
                                                            <br>
                                                            <i class="fa fa-frown-o"></i><font color="ed5565"> @tarefa.HorasRestantes.ToString().Replace("-", "") horas excedidas</font>
                                                        </text>
                                                    }
                                                }
                                            </div>
                                        </li>
                                    }
                                    else if (tarefa.IdTipoTarefa == 2)
                                    {
                                        <li class="warning-element image-align" id="@tarefa.IdTarefa" data-idworkflow="@workflow.IdWorkflow" style="background-image:url(../gif/gif-problema.gif);">
                                            @tarefa.Nome
                                            <div class="agile-detail">
                                                <i class="fa fa-clock-o"></i> @tarefa.DataTermino.Value.ToString("dd/MM/yyyy")
                                                <div class="m-xxs m-l-none"><i class="fa fa-user"></i> #@tarefa.IdTarefa criada por @tarefa.Recurso.Nome</div>
                                                <i class="fa fa-plus-square-o"></i> <font color="1c84c6"> @tarefa.QtdHoras horas planejadas</font>
                                                @if (@tarefa.HorasConsumidas != 0)
                                                {
                                                    <br>
                                                    <i class="fa fa-minus-square-o"></i> <font color="f8ac59">  @tarefa.HorasConsumidas horas consumidas</font>
                                                    if (@tarefa.HorasRestantes >= 0)
                                                    {
                                                        <text>
                                                            <br>
                                                            <i class="fa fa-smile-o"></i> <font color="1ab394"> @tarefa.HorasRestantes horas restantes</font>
                                                        </text>
                                                    }
                                                    else
                                                    {
                                                        <text>
                                                            <br>
                                                            <i class="fa fa-frown-o"></i><font color="ed5565"> @tarefa.HorasRestantes.ToString().Replace("-", "") horas excedidas</font>
                                                        </text>
                                                    }
                                                }
                                            </div>
                                        </li>
                                    }
                                    else if (tarefa.IdTipoTarefa == 3)
                                    {
                                        <li class="warning-element image-align" id="@tarefa.IdTarefa" data-idworkflow="@workflow.IdWorkflow" style="background-image:url(../gif/gif-melhoria.gif);">
                                            @tarefa.Nome
                                            <div class="agile-detail">
                                                <i class="fa fa-clock-o"></i> @tarefa.DataTermino.Value.ToString("dd/MM/yyyy")
                                                <div class="m-xxs m-l-none"><i class="fa fa-user"></i> #@tarefa.IdTarefa criada por @tarefa.Recurso.Nome</div>
                                                <i class="fa fa-plus-square-o"></i> <font color="1c84c6"> @tarefa.QtdHoras horas planejadas</font>
                                                @if (@tarefa.HorasConsumidas != 0)
                                                {
                                                    <br>
                                                    <i class="fa fa-minus-square-o"></i> <font color="f8ac59">  @tarefa.HorasConsumidas horas consumidas</font>
                                                    if (@tarefa.HorasRestantes >= 0)
                                                    {
                                                        <text>
                                                            <br>
                                                            <i class="fa fa-smile-o"></i> <font color="1ab394"> @tarefa.HorasRestantes horas restantes</font>
                                                        </text>
                                                    }
                                                    else
                                                    {
                                                        <text>
                                                            <br>
                                                            <i class="fa fa-frown-o"></i><font color="ed5565"> @tarefa.HorasRestantes.ToString().Replace("-", "") horas excedidas</font>
                                                        </text>
                                                    }
                                                }
                                            </div>
                                        </li>
                                    }
                                    else if (tarefa.IdTipoTarefa == 4)
                                    {
                                        <li class="warning-element image-align" id="@tarefa.IdTarefa" data-idworkflow="@workflow.IdWorkflow" style="background-image:url(../gif/gif-requisicao.gif);">
                                            @tarefa.Nome
                                            <div class="agile-detail">
                                                <i class="fa fa-clock-o"></i> @tarefa.DataTermino.Value.ToString("dd/MM/yyyy")
                                                <div class="m-xxs m-l-none"><i class="fa fa-user"></i> #@tarefa.IdTarefa criada por @tarefa.Recurso.Nome</div>
                                                <i class="fa fa-plus-square-o"></i> <font color="1c84c6"> @tarefa.QtdHoras horas planejadas</font>
                                                @if (@tarefa.HorasConsumidas != 0)
                                                {
                                                    <br>
                                                    <i class="fa fa-minus-square-o"></i> <font color="f8ac59">  @tarefa.HorasConsumidas horas consumidas</font>
                                                    if (@tarefa.HorasRestantes >= 0)
                                                    {
                                                        <text>
                                                            <br>
                                                            <i class="fa fa-smile-o"></i> <font color="1ab394"> @tarefa.HorasRestantes horas restantes</font>
                                                        </text>
                                                    }
                                                    else
                                                    {
                                                        <text>
                                                            <br>
                                                            <i class="fa fa-frown-o"></i><font color="ed5565"> @tarefa.HorasRestantes.ToString().Replace("-", "") horas excedidas</font>
                                                        </text>
                                                    }
                                                }
                                            </div>
                                        </li>
                                    }
                                    <!--<li class="warning-element" id="@tarefa.IdTarefa" data-idworkflow="@workflow.IdWorkflow">
                                        @tarefa.Nome
                                        <div class="agile-detail">
                                            <i class="fa fa-clock-o"></i> @tarefa.DataTermino.Value.ToString("dd/MM/yyyy")
                                            <div class="m-xxs m-l-none"><i class="fa fa-user"></i> #@tarefa.IdTarefa criada por @tarefa.Recurso.Nome</div>
                                            <i class="fa fa-plus-square-o"></i> <font color="1c84c6"> @tarefa.QtdHoras horas planejadas</font>
                                            @if (@tarefa.HorasConsumidas != 0)
                                            {
                                                <br>
                                                <i class="fa fa-minus-square-o"></i> <font color="f8ac59">  @tarefa.HorasConsumidas horas consumidas</font>
                                                if (@tarefa.HorasRestantes >= 0)
                                                {
                                                    <text>
                                                    <br>
                                                    <i class="fa fa-smile-o"></i> <font color="1ab394"> @tarefa.HorasRestantes horas restantes</font>
                                                    </text>
                                                }
                                                else
                                                {
                                                    <text>
                                                    <br>
                                                    <i class="fa fa-frown-o"></i><font color="ed5565"> @tarefa.HorasRestantes.ToString().Replace("-", "") horas excedidas</font>
                                                    </text>
                                                }
                                            }
                                        </div>
                                    </li>-->
                                }
                                else if (DateTime.Now.Date > tarefa.DataTermino && tarefa.PercentualConcluido != 100)
                                {
                                    if (tarefa.IdTipoTarefa == 1)
                                    {
                                        <li class="danger-element image-align" id="@tarefa.IdTarefa" data-idworkflow="@workflow.IdWorkflow" style="background-image:url(../gif/gif-projeto.gif);">
                                            @tarefa.Nome
                                            <div class="agile-detail">
                                                <i class="fa fa-clock-o"></i> @tarefa.DataTermino.Value.ToString("dd/MM/yyyy")
                                                <div class="m-xxs m-l-none"><i class="fa fa-user"></i> #@tarefa.IdTarefa criada por @tarefa.Recurso.Nome</div>
                                                <i class="fa fa-plus-square-o"></i> <font color="1c84c6"> @tarefa.QtdHoras horas planejadas</font>
                                                @if (@tarefa.HorasConsumidas != 0)
                                                {
                                                    <br>
                                                    <i class="fa fa-minus-square-o"></i> <font color="f8ac59">  @tarefa.HorasConsumidas horas consumidas</font>
                                                    if (@tarefa.HorasRestantes >= 0)
                                                    {
                                                        <text>
                                                            <br>
                                                            <i class="fa fa-smile-o"></i> <font color="1ab394"> @tarefa.HorasRestantes horas restantes</font>
                                                        </text>
                                                    }
                                                    else
                                                    {
                                                        <text>
                                                            <br>
                                                            <i class="fa fa-frown-o"></i><font color="ed5565"> @tarefa.HorasRestantes.ToString().Replace("-", "") horas excedidas</font>
                                                        </text>
                                                    }
                                                }
                                            </div>
                                        </li>
                                    }
                                    else if (tarefa.IdTipoTarefa == 2)
                                    {
                                        <li class="danger-element image-align" id="@tarefa.IdTarefa" data-idworkflow="@workflow.IdWorkflow" style="background-image:url(../gif/gif-problema.gif);">
                                            @tarefa.Nome
                                            <div class="agile-detail">
                                                <i class="fa fa-clock-o"></i> @tarefa.DataTermino.Value.ToString("dd/MM/yyyy")
                                                <div class="m-xxs m-l-none"><i class="fa fa-user"></i> #@tarefa.IdTarefa criada por @tarefa.Recurso.Nome</div>
                                                <i class="fa fa-plus-square-o"></i> <font color="1c84c6"> @tarefa.QtdHoras horas planejadas</font>
                                                @if (@tarefa.HorasConsumidas != 0)
                                                {
                                                    <br>
                                                    <i class="fa fa-minus-square-o"></i> <font color="f8ac59">  @tarefa.HorasConsumidas horas consumidas</font>
                                                    if (@tarefa.HorasRestantes >= 0)
                                                    {
                                                        <text>
                                                            <br>
                                                            <i class="fa fa-smile-o"></i> <font color="1ab394"> @tarefa.HorasRestantes horas restantes</font>
                                                        </text>
                                                    }
                                                    else
                                                    {
                                                        <text>
                                                            <br>
                                                            <i class="fa fa-frown-o"></i><font color="ed5565"> @tarefa.HorasRestantes.ToString().Replace("-", "") horas excedidas</font>
                                                        </text>
                                                    }
                                                }
                                            </div>
                                        </li>
                                    }
                                    else if (tarefa.IdTipoTarefa == 3)
                                    {
                                        <li class="danger-element image-align" id="@tarefa.IdTarefa" data-idworkflow="@workflow.IdWorkflow" style="background-image:url(../gif/gif-melhoria.gif);">
                                            @tarefa.Nome
                                            <div class="agile-detail">
                                                <i class="fa fa-clock-o"></i> @tarefa.DataTermino.Value.ToString("dd/MM/yyyy")
                                                <div class="m-xxs m-l-none"><i class="fa fa-user"></i> #@tarefa.IdTarefa criada por @tarefa.Recurso.Nome</div>
                                                <i class="fa fa-plus-square-o"></i> <font color="1c84c6"> @tarefa.QtdHoras horas planejadas</font>
                                                @if (@tarefa.HorasConsumidas != 0)
                                                {
                                                    <br>
                                                    <i class="fa fa-minus-square-o"></i> <font color="f8ac59">  @tarefa.HorasConsumidas horas consumidas</font>
                                                    if (@tarefa.HorasRestantes >= 0)
                                                    {
                                                        <text>
                                                            <br>
                                                            <i class="fa fa-smile-o"></i> <font color="1ab394"> @tarefa.HorasRestantes horas restantes</font>
                                                        </text>
                                                    }
                                                    else
                                                    {
                                                        <text>
                                                            <br>
                                                            <i class="fa fa-frown-o"></i><font color="ed5565"> @tarefa.HorasRestantes.ToString().Replace("-", "") horas excedidas</font>
                                                        </text>
                                                    }
                                                }
                                            </div>
                                        </li>
                                    }
                                    else if (tarefa.IdTipoTarefa == 4)
                                    {
                                        <li class="danger-element image-align" id="@tarefa.IdTarefa" data-idworkflow="@workflow.IdWorkflow" style="background-image:url(../gif/gif-requisicao.gif);">
                                            @tarefa.Nome
                                            <div class="agile-detail">
                                                <i class="fa fa-clock-o"></i> @tarefa.DataTermino.Value.ToString("dd/MM/yyyy")
                                                <div class="m-xxs m-l-none"><i class="fa fa-user"></i> #@tarefa.IdTarefa criada por @tarefa.Recurso.Nome</div>
                                                <i class="fa fa-plus-square-o"></i> <font color="1c84c6"> @tarefa.QtdHoras horas planejadas</font>
                                                @if (@tarefa.HorasConsumidas != 0)
                                                {
                                                    <br>
                                                    <i class="fa fa-minus-square-o"></i> <font color="f8ac59">  @tarefa.HorasConsumidas horas consumidas</font>
                                                    if (@tarefa.HorasRestantes >= 0)
                                                    {
                                                        <text>
                                                            <br>
                                                            <i class="fa fa-smile-o"></i> <font color="1ab394"> @tarefa.HorasRestantes horas restantes</font>
                                                        </text>
                                                    }
                                                    else
                                                    {
                                                        <text>
                                                            <br>
                                                            <i class="fa fa-frown-o"></i><font color="ed5565"> @tarefa.HorasRestantes.ToString().Replace("-", "") horas excedidas</font>
                                                        </text>
                                                    }
                                                }
                                            </div>
                                        </li>
                                    }
                                    <!--<li class="danger-element" id="@tarefa.IdTarefa" data-idworkflow="@workflow.IdWorkflow">
                                        @tarefa.Nome
                                        <div class="agile-detail">
                                            <i class="fa fa-clock-o"></i> @tarefa.DataTermino.Value.ToString("dd/MM/yyyy")
                                            <div class="m-xxs m-l-none"><i class="fa fa-user"></i> #@tarefa.IdTarefa criada por @tarefa.Recurso.Nome</div>
                                            <i class="fa fa-plus-square-o"></i> <font color="1c84c6"> @tarefa.QtdHoras horas planejadas</font>
                                            @if (@tarefa.HorasConsumidas != 0)
                                            {
                                                <br>
                                                <i class="fa fa-minus-square-o"></i> <font color="f8ac59">  @tarefa.HorasConsumidas horas consumidas</font>
                                                if (@tarefa.HorasRestantes >= 0)
                                                {
                                                    <text>
                                                    <br>
                                                    <i class="fa fa-smile-o"></i> <font color="1ab394"> @tarefa.HorasRestantes horas restantes</font>
                                                    </text>
                                                }
                                                else
                                                {
                                                    <text>
                                                    <br>
                                                    <i class="fa fa-frown-o"></i><font color="ed5565"> @tarefa.HorasRestantes.ToString().Replace("-", "") horas excedidas</font>
                                                    </text>
                                                }
                                            }
                                        </div>
                                    </li>-->
                                }
                                else
                                {
                                    if (tarefa.IdTipoTarefa == 1)
                                    {
                                        <li class="info-element image-align" id="@tarefa.IdTarefa" data-idworkflow="@workflow.IdWorkflow" style="background-image:url(../gif/gif-projeto.gif);">
                                            @tarefa.Nome
                                            <div class="agile-detail">
                                                <i class="fa fa-clock-o"></i> @tarefa.DataTermino.Value.ToString("dd/MM/yyyy")
                                                <div class="m-xxs m-l-none"><i class="fa fa-user"></i> #@tarefa.IdTarefa criada por @tarefa.Recurso.Nome</div>
                                                <i class="fa fa-plus-square-o"></i> <font color="1c84c6"> @tarefa.QtdHoras horas planejadas</font>
                                                @if (@tarefa.HorasConsumidas != 0)
                                                {
                                                    <br>
                                                    <i class="fa fa-minus-square-o"></i> <font color="f8ac59">  @tarefa.HorasConsumidas horas consumidas</font>
                                                    if (@tarefa.HorasRestantes >= 0)
                                                    {
                                                        <text>
                                                            <br>
                                                            <i class="fa fa-smile-o"></i> <font color="1ab394"> @tarefa.HorasRestantes horas restantes</font>
                                                        </text>
                                                    }
                                                    else
                                                    {
                                                        <text>
                                                            <br>
                                                            <i class="fa fa-frown-o"></i><font color="ed5565"> @tarefa.HorasRestantes.ToString().Replace("-", "") horas excedidas</font>
                                                        </text>
                                                    }
                                                }
                                            </div>
                                        </li>
                                    }
                                    else if (tarefa.IdTipoTarefa == 2)
                                    {
                                        <li class="info-element image-align" id="@tarefa.IdTarefa" data-idworkflow="@workflow.IdWorkflow" style="background-image:url(../gif/gif-problema.gif);">
                                            @tarefa.Nome
                                            <div class="agile-detail">
                                                <i class="fa fa-clock-o"></i> @tarefa.DataTermino.Value.ToString("dd/MM/yyyy")
                                                <div class="m-xxs m-l-none"><i class="fa fa-user"></i> #@tarefa.IdTarefa criada por @tarefa.Recurso.Nome</div>
                                                <i class="fa fa-plus-square-o"></i> <font color="1c84c6"> @tarefa.QtdHoras horas planejadas</font>
                                                @if (@tarefa.HorasConsumidas != 0)
                                                {
                                                    <br>
                                                    <i class="fa fa-minus-square-o"></i> <font color="f8ac59">  @tarefa.HorasConsumidas horas consumidas</font>
                                                    if (@tarefa.HorasRestantes >= 0)
                                                    {
                                                        <text>
                                                            <br>
                                                            <i class="fa fa-smile-o"></i> <font color="1ab394"> @tarefa.HorasRestantes horas restantes</font>
                                                        </text>
                                                    }
                                                    else
                                                    {
                                                        <text>
                                                            <br>
                                                            <i class="fa fa-frown-o"></i><font color="ed5565"> @tarefa.HorasRestantes.ToString().Replace("-", "") horas excedidas</font>
                                                        </text>
                                                    }
                                                }
                                            </div>
                                        </li>
                                    }
                                    else if (tarefa.IdTipoTarefa == 3)
                                    {
                                        <li class="info-element image-align" id="@tarefa.IdTarefa" data-idworkflow="@workflow.IdWorkflow" style="background-image:url(../gif/gif-melhoria.gif);">
                                            @tarefa.Nome
                                            <div class="agile-detail">
                                                <i class="fa fa-clock-o"></i> @tarefa.DataTermino.Value.ToString("dd/MM/yyyy")
                                                <div class="m-xxs m-l-none"><i class="fa fa-user"></i> #@tarefa.IdTarefa criada por @tarefa.Recurso.Nome</div>
                                                <i class="fa fa-plus-square-o"></i> <font color="1c84c6"> @tarefa.QtdHoras horas planejadas</font>
                                                @if (@tarefa.HorasConsumidas != 0)
                                                {
                                                    <br>
                                                    <i class="fa fa-minus-square-o"></i> <font color="f8ac59">  @tarefa.HorasConsumidas horas consumidas</font>
                                                    if (@tarefa.HorasRestantes >= 0)
                                                    {
                                                        <text>
                                                            <br>
                                                            <i class="fa fa-smile-o"></i> <font color="1ab394"> @tarefa.HorasRestantes horas restantes</font>
                                                        </text>
                                                    }
                                                    else
                                                    {
                                                        <text>
                                                            <br>
                                                            <i class="fa fa-frown-o"></i><font color="ed5565"> @tarefa.HorasRestantes.ToString().Replace("-", "") horas excedidas</font>
                                                        </text>
                                                    }
                                                }
                                            </div>
                                        </li>
                                    }
                                    else if (tarefa.IdTipoTarefa == 4)
                                    {
                                        <li class="info-element image-align" id="@tarefa.IdTarefa" data-idworkflow="@workflow.IdWorkflow" style="background-image:url(../gif/gif-requisicao.gif);">
                                            @tarefa.Nome
                                            <div class="agile-detail">
                                                <i class="fa fa-clock-o"></i> @tarefa.DataTermino.Value.ToString("dd/MM/yyyy")
                                                <div class="m-xxs m-l-none"><i class="fa fa-user"></i> #@tarefa.IdTarefa criada por @tarefa.Recurso.Nome</div>
                                                <i class="fa fa-plus-square-o"></i> <font color="1c84c6"> @tarefa.QtdHoras horas planejadas</font>
                                                @if (@tarefa.HorasConsumidas != 0)
                                                {
                                                    <br>
                                                    <i class="fa fa-minus-square-o"></i> <font color="f8ac59">  @tarefa.HorasConsumidas horas consumidas</font>
                                                    if (@tarefa.HorasRestantes >= 0)
                                                    {
                                                        <text>
                                                            <br>
                                                            <i class="fa fa-smile-o"></i> <font color="1ab394"> @tarefa.HorasRestantes horas restantes</font>
                                                        </text>
                                                    }
                                                    else
                                                    {
                                                        <text>
                                                            <br>
                                                            <i class="fa fa-frown-o"></i><font color="ed5565"> @tarefa.HorasRestantes.ToString().Replace("-", "") horas excedidas</font>
                                                        </text>
                                                    }
                                                }
                                            </div>
                                        </li>
                                    }
                                    <!--<li class="info-element" id="@tarefa.IdTarefa" data-idworkflow="@workflow.IdWorkflow">
                                        @tarefa.Nome
                                        <div class="agile-detail">
                                            <i class="fa fa-clock-o"></i> @tarefa.DataTermino.Value.ToString("dd/MM/yyyy")
                                            <div class="m-xxs m-l-none"><i class="fa fa-user"></i> #@tarefa.IdTarefa criada por @tarefa.Recurso.Nome</div>
                                            <i class="fa fa-plus-square-o"></i> <font color="1c84c6"> @tarefa.QtdHoras horas planejadas</font>
                                            @if (@tarefa.HorasConsumidas != 0)
                                            {
                                                <br>
                                                <i class="fa fa-minus-square-o"></i> <font color="f8ac59">  @tarefa.HorasConsumidas horas consumidas</font>
                                                if (@tarefa.HorasRestantes >= 0)
                                                {
                                                    <text>
                                                    <br>
                                                    <i class="fa fa-smile-o"></i> <font color="1ab394"> @tarefa.HorasRestantes horas restantes</font>
                                                    </text>
                                                }
                                                else
                                                {
                                                    <text>
                                                    <br>
                                                    <i class="fa fa-frown-o"></i><font color="ed5565"> @tarefa.HorasRestantes.ToString().Replace("-", "") horas excedidas</font>
                                                    </text>
                                                }
                                            }
                                        </div>
                                    </li>-->
                                }
                            }
                        </ul>
                    </div>
                </div>
            </div>
        }
    }
</div>

@section Scripts {
    <!-- jquery UI -->
    <script src="~/js/plugins/jquery-ui/jquery-ui.min.js"></script>
    <!-- Touch Punch - Touch Event Support for jQuery UI -->
    <script src="~/js/plugins/touchpunch/jquery.ui.touch-punch.min.js"></script>
    <!-- Toastr script -->
    <script src="~/js/plugins/toastr/toastr.min.js"></script>
    <!-- SignalR -->
    <script src="~/js/signalr-client-1.0.0-alpha2-final.min.js"></script>
    @if (Model.Lista != null)
    {
        foreach (var workflow in Model.Lista)
        {
            <script>
                $(document).ready(function(){

                    $("#workflow-id-@workflow.IdWorkflow").sortable({
                        connectWith: ".connectList",
                        update: function( event, ui ) {

                            var idsTarefa = $("#workflow-id-@workflow.IdWorkflow").sortable("toArray");

                            for (i = 0; i < idsTarefa.length; i++) {

                                var idTarefa = idsTarefa[i];

                                var idWorkflowTarefa = $("#" + idTarefa).data("idworkflow");
                                var idWorkflowColuna = @workflow.IdWorkflow;

                                if (idWorkflowColuna != idWorkflowTarefa) {

                                    $.ajax({
                                        type: "POST",
                                        url: "/FluxoTrabalho",
                                        data: { idTarefa: idTarefa, idWorkflow: idWorkflowColuna },
                                        beforeSend: function (xhr) {

                                            xhr.setRequestHeader("XSRF-TOKEN",
                                                $('input:hidden[name="__RequestVerificationToken"]').val());
                                        },
                                        success: function (response) {

                                            $("#workflow-animate-" + idWorkflowTarefa).removeAttr('class').attr('class', '');
                                            $("#workflow-animate-" + idWorkflowTarefa).addClass('animated');
                                            $("#workflow-animate-" + idWorkflowTarefa).addClass('flash');

                                            $("#workflow-badge-" + idWorkflowTarefa).empty();
                                            $("#workflow-badge-" + idWorkflowTarefa).append($("#workflow-id-" + idWorkflowTarefa).sortable("toArray").length);

                                            $("#" + idTarefa).data("idworkflow", idWorkflowColuna);

                                            $("#workflow-animate-@workflow.IdWorkflow").removeAttr('class').attr('class', '');
                                            $("#workflow-animate-@workflow.IdWorkflow").addClass('animated');
                                            $("#workflow-animate-@workflow.IdWorkflow").addClass('flash');

                                            $("#workflow-badge-@workflow.IdWorkflow").empty();
                                            $("#workflow-badge-@workflow.IdWorkflow").append(idsTarefa.length);

                                            toastr.options = {
                                                "closeButton": true,
                                                "debug": false,
                                                "progressBar": true,
                                                "preventDuplicates": false,
                                                "positionClass": "toast-bottom-right",
                                                "onclick": null,
                                                "showDuration": "400",
                                                "hideDuration": "1000",
                                                "timeOut": "7000",
                                                "extendedTimeOut": "1000",
                                                "showEasing": "swing",
                                                "hideEasing": "linear",
                                                "showMethod": "fadeIn",
                                                "hideMethod": "fadeOut"
                                            }

                                            toastr.success("Tarefa #" + idTarefa + " movida com sucesso para a etapa de @workflow.Nome")
                                        },
                                        failure: function (response) {

                                            toastr.error("Falha ao mover tarefa #" + idTarefa + " para a etapa de @workflow.Nome")
                                        }
                                    });
                                }
                            }
                        }
                    }).disableSelection();

                });
            </script>
        }
    }
    <script>
        //var transport = signalR.TransportType.All;
        var transport = signalR.TransportType.ServerSentEvents;

        var connection = new signalR.HubConnection('/hubs/fluxoTrabalho', { transport: transport });

        connection.on('send', data => {
            console.log(data);
        });

        connection.start();
    </script>
}